{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}EcoRaci贸n{% endblock %}</title>
    <script>
        // Aplicar tema oscuro inmediatamente si el usuario lo guard贸 en localStorage
        (function(){
            try {
                var dark = localStorage.getItem('modo_oscuro');
                if (dark === '1') {
                    document.documentElement.classList.add('dark');
                }
            } catch(e) {
                // no hacer nada si localStorage no est谩 disponible
            }
        })();
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'panel/css/estilos.css' %}">
    <script src="{% static 'panel/js/alertas.js' %}?v=4"></script>
</head>
<body>

<div class="layout-wrapper">

    <!-- SIDEBAR -->
    <aside class="sidebar">
        <div class="sidebar-logo">
            <div class="sidebar-logo-icon"></div>
            <div class="sidebar-logo-text">EcoRaci贸n</div>
        </div>

        <!-- STOCK DINMICO -->
        <div class="sidebar-stock p-2 mb-2">
            {% if insumos %}
                <h6 class="mb-1">Stock Actual</h6>
                <ul class="list-unstyled">
                    {% for nombre, datos in insumos.items %}
                        <li class="d-flex justify-content-between align-items-center mb-1">
                            <span>{{ nombre|capfirst }}: {{ datos.stock_actual }} {{ datos.unidad }}</span>
                            {% if datos.nivel_alerta == "CRITICO" %}
                                <span class="badge bg-danger">Cr铆tico</span>
                            {% elif datos.nivel_alerta == "BAJO" %}
                                <span class="badge bg-warning text-dark">Bajo</span>
                            {% else %}
                                <span class="badge bg-success">OK</span>
                            {% endif %}
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>

        <ul class="sidebar-menu">
            <!-- INICIO -->
            <li><a href="{% url 'dashboard' %}" class="sidebar-link {% if request.path == '/dashboard/' %}active{% endif %}">Inicio</a></li>
            
            <!-- GESTIN DE RACIONES -->
            <li class="sidebar-section">Gesti贸n de Raciones</li>
            <li><a href="{% url 'raciones' %}" class="sidebar-link {% if request.path == '/raciones/' %}active{% endif %}">Crear Raci贸n</a></li>
            <li><a href="{% url 'registros' %}" class="sidebar-link {% if request.path == '/registros/' %}active{% endif %}">Historial de Raciones</a></li>
            <li><a href="{% url 'proyecciones' %}" class="sidebar-link {% if request.path == '/proyecciones/' %}active{% endif %}">Proyecciones</a></li>
            
            <!-- PRODUCCIN -->
            <li class="sidebar-section">Producci贸n</li>
            <li><a href="{% url 'produccion_huevos' %}" class="sidebar-link {% if request.path == '/produccion-huevos/' %}active{% endif %}">Producci贸n de Huevos</a></li>
            
            <!-- INVENTARIO -->
            <li class="sidebar-section">Inventario</li>
            <li><a href="{% url 'stock' %}" class="sidebar-link {% if request.path == '/stock/' %}active{% endif %}">Gesti贸n de Stock</a></li>
            
            <!-- REPORTES Y CONFIGURACIN -->
            <li class="sidebar-section">Sistema</li>
            <li><a href="{% url 'configuraciones' %}" class="sidebar-link {% if request.path == '/configuraciones/' %}active{% endif %}">Configuraci贸n</a></li>
            <li><a href="{% url 'logout' %}" class="sidebar-link">Cerrar sesi贸n</a></li>
        </ul>
    </aside>

    <!-- CONTENIDO PRINCIPAL -->
    <main class="main-content">
        <div class="card-main">
            {% block content %}{% endblock %}
        </div>
    </main>

</div>

{% block extra_js %}{% endblock %}

</body>
</html>
